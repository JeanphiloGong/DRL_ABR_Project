ä¸ºäº†å®Œæˆ **æ·±åº¦å¼ºåŒ–å­¦ä¹ ï¼ˆDRLï¼‰ä»»åŠ¡**ï¼Œä½ éœ€è¦å‡†å¤‡**ä¸€ç»„è§†é¢‘**ï¼Œç„¶åè½¬æ¢ä¸º **DASH æ ¼å¼ï¼ˆMPD + MP4 ç‰‡æ®µï¼‰**ï¼Œä»¥ä¾¿è®­ç»ƒä½ çš„ ABRï¼ˆè‡ªé€‚åº”ç ç‡ï¼‰ç®—æ³•ã€‚æ•´ä¸ªæµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š

---

# **ğŸ› ï¸ å®Œæ•´æµç¨‹**
## **ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡è§†é¢‘**
ä½ éœ€è¦è·å–ä¸€äº›è§†é¢‘ç´ æï¼Œæ¥æºå¯ä»¥æ˜¯ï¼š
1. **å¼€æºè§†é¢‘æ•°æ®é›†**
   - **[Harmonic Dataset](https://www.harmonicinc.com/resources/)**ï¼šæä¾›ä¸åŒç ç‡çš„è§†é¢‘æµ
   - **[YouTube å…¬å¼€è§†é¢‘](https://www.youtube.com/)**ï¼šå¯ä»¥ä½¿ç”¨ `yt-dlp` ä¸‹è½½
   - **[Open Video Project](http://www.open-video.org/)**ï¼šæä¾›å…¬å¼€çš„è§†é¢‘æ•°æ®

2. **ä¸‹è½½ YouTube è§†é¢‘ï¼ˆå¯é€‰ï¼‰**
   ä½ å¯ä»¥ä½¿ç”¨ `yt-dlp` ä¸‹è½½ YouTube è§†é¢‘ï¼š
   ```bash
   yt-dlp -f best -o "video.mp4" "https://www.youtube.com/watch?v=XXXXXXX"
   ```

3. **ä½¿ç”¨ ffmpeg è£å‰ªè§†é¢‘ï¼ˆå¯é€‰ï¼‰**
   ä½ å¯èƒ½éœ€è¦ç¼©çŸ­è§†é¢‘é•¿åº¦ï¼Œä¿è¯å¤„ç†æ—¶é—´å¯æ§ï¼š
   ```bash
   ffmpeg -i video.mp4 -t 60 -c copy video_short.mp4  # æˆªå–å‰ 60 ç§’
   ```

---

## **ç¬¬äºŒæ­¥ï¼šè½¬æ¢è§†é¢‘ä¸ºå¤šç ç‡ MP4**
DASH éœ€è¦å¤šä¸ªä¸åŒç ç‡çš„è§†é¢‘ç‰ˆæœ¬ï¼Œä½ å¯ä»¥ä½¿ç”¨ `ffmpeg` è¿›è¡Œè½¬æ¢ï¼š
```bash
ffmpeg -i video.mp4 -c:v libx264 -b:v 500k -vf scale=640:360 360p.mp4
ffmpeg -i video.mp4 -c:v libx264 -b:v 1000k -vf scale=1280:720 720p.mp4
ffmpeg -i video.mp4 -c:v libx264 -b:v 2500k -vf scale=1920:1080 1080p.mp4
```
è¿™é‡Œï¼š
- `-b:v 500k` â†’ 360p ç ç‡
- `-b:v 1000k` â†’ 720p ç ç‡
- `-b:v 2500k` â†’ 1080p ç ç‡

å¦‚æœä½ çš„å®éªŒæ¶‰åŠ **ä½å¸¦å®½ç¯å¢ƒ**ï¼Œä½ å¯èƒ½è¿˜éœ€è¦æ›´ä½çš„ç ç‡ï¼š
```bash
ffmpeg -i video.mp4 -c:v libx264 -b:v 250k -vf scale=426:240 240p.mp4
```

---

## **ç¬¬ä¸‰æ­¥ï¼šç”Ÿæˆ DASH (MPD) æ–‡ä»¶**
ä½ éœ€è¦ä½¿ç”¨ `MP4Box` æ¥åˆ‡ç‰‡å¹¶ç”Ÿæˆ MPD æ–‡ä»¶ï¼š
```bash
MP4Box -dash 4000 -frag 4000 -rap -segment-name segment_ -url-template -out manifest.mpd 360p.mp4 720p.mp4 1080p.mp4
```
- `-dash 4000`ï¼šDASH æ®µçš„æ—¶é—´é•¿åº¦ï¼ˆmsï¼‰
- `-frag 4000`ï¼šæ¯ä¸ªç‰‡æ®µçš„é•¿åº¦
- `-segment-name segment_`ï¼šç”Ÿæˆçš„ DASH ç‰‡æ®µæ–‡ä»¶åï¼Œå¦‚ `segment_1.m4s`
- `-out manifest.mpd`ï¼šæœ€ç»ˆç”Ÿæˆ MPD æ–‡ä»¶

æ‰§è¡Œå®Œåï¼Œä½ çš„ç›®å½•ç»“æ„ä¼šæ˜¯ï¼š
```
ğŸ“‚ dash_content/
 â”œâ”€â”€ ğŸ“œ manifest.mpd
 â”œâ”€â”€ ğŸ“‚ video_360p/
 â”‚    â”œâ”€â”€ segment_1.m4s
 â”‚    â”œâ”€â”€ segment_2.m4s
 â”‚    â”œâ”€â”€ segment_3.m4s
 â”‚    â”œâ”€â”€ ...
 â”œâ”€â”€ ğŸ“‚ video_720p/
 â”‚    â”œâ”€â”€ segment_1.m4s
 â”‚    â”œâ”€â”€ segment_2.m4s
 â”‚    â”œâ”€â”€ ...
 â”œâ”€â”€ ğŸ“‚ video_1080p/
 â”‚    â”œâ”€â”€ segment_1.m4s
 â”‚    â”œâ”€â”€ segment_2.m4s
 â”‚    â”œâ”€â”€ ...
```

---

## **ç¬¬å››æ­¥ï¼šé…ç½® Nginx æä¾› DASH æµ**
ä½ éœ€è¦ç¡®ä¿ Nginx èƒ½å¤Ÿæ­£ç¡®æä¾› `MPD` å’Œ `m4s` ç‰‡æ®µï¼š

### **ä¿®æ”¹ Nginx é…ç½®**
```nginx
server {
    listen 80;
    server_name your_server_ip;

    root /home/easyai/Dashå®¢æˆ·ç«¯/DRL_ABR_Project/dash_content;
    index index.html;

    location /dash_content/ {
        add_header Access-Control-Allow-Origin *;
        add_header Access-Control-Allow-Methods 'GET, OPTIONS';
        add_header Access-Control-Allow-Headers 'Range';

        types {
            application/dash+xml mpd;
            video/mp4 mp4;
            video/webm webm;
        }
    }
}
```
ç„¶åï¼š
```bash
sudo nginx -t
sudo systemctl reload nginx
```
åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š
```plaintext
http://your_server_ip/dash_content/manifest.mpd
```
å¦‚æœ MPD æ–‡ä»¶å¯ä»¥è®¿é—®ï¼Œè¯´æ˜ Nginx é…ç½®æˆåŠŸã€‚

---

## **ç¬¬äº”æ­¥ï¼šç”¨ DASH.js æ’­æ”¾ DASH è§†é¢‘**
åˆ›å»º `index.html`ï¼š
```html
<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.dashjs.org/latest/dash.all.min.js"></script>
</head>
<body>
    <video id="videoPlayer" controls></video>
    <script>
        var url = "http://your_server_ip/dash_content/manifest.mpd";
        var player = dashjs.MediaPlayer().create();
        player.initialize(document.querySelector("#videoPlayer"), url, true);
    </script>
</body>
</html>
```
è®¿é—® `http://your_server_ip/index.html`ï¼Œæ£€æŸ¥ DASH.js æ˜¯å¦èƒ½æ’­æ”¾ DASH æµã€‚

---

## **ç¬¬å…­æ­¥ï¼šé‡‡é›†è®­ç»ƒæ•°æ®**
ä½ éœ€è¦ä¿®æ”¹ DASH.js å®¢æˆ·ç«¯ï¼Œè®©å®ƒè®°å½• **å¸¦å®½ã€ç ç‡ã€ç¼“å†²æƒ…å†µ**ï¼š
```javascript
player.on(dashjs.MediaPlayer.events.QUALITY_CHANGE_RENDERED, function(event) {
    console.log("New bitrate: " + player.getQualityFor('video'));
});

player.on(dashjs.MediaPlayer.events.BUFFER_LEVEL_UPDATED, function(event) {
    console.log("Buffer Level: " + event.bufferLevel + " seconds");
});
```
ä½ å¯ä»¥å°†è¿™äº›æ•°æ®å­˜å…¥æ—¥å¿—æ–‡ä»¶ï¼Œç„¶åç”¨ Python å¤„ç†æ•°æ®ï¼Œä¸º DRL è®­ç»ƒå‡†å¤‡æ•°æ®é›†ã€‚

---

## **ç¬¬ä¸ƒæ­¥ï¼šè®­ç»ƒ DRL æ¨¡å‹**
### **1. å®šä¹‰ DRL è®­ç»ƒæ•°æ®**
ä½ çš„æ•°æ®æ ¼å¼å¯ä»¥æ˜¯ï¼š
```
timestamp, throughput, buffer_level, chosen_bitrate, rebuffering_duration
100, 1200kbps, 4.2s, 720p, 0.3s
200, 900kbps, 3.8s, 360p, 0.0s
...
```
ä½ å¯ä»¥ä½¿ç”¨ Python å¤„ç†æ—¥å¿—å¹¶å­˜å‚¨ä¸º CSV æˆ– JSONï¼š
```python
import pandas as pd

data = [
    {"timestamp": 100, "throughput": 1200, "buffer_level": 4.2, "chosen_bitrate": "720p", "rebuffering_duration": 0.3},
    {"timestamp": 200, "throughput": 900, "buffer_level": 3.8, "chosen_bitrate": "360p", "rebuffering_duration": 0.0},
]

df = pd.DataFrame(data)
df.to_csv("training_data.csv", index=False)
```

### **2. è®­ç»ƒ DRL æ¨¡å‹**
ä½ å¯ä»¥ä½¿ç”¨ **PPOã€DQN æˆ– A3C** è®­ç»ƒæ¨¡å‹ï¼š
```python
import torch
import gym
from stable_baselines3 import PPO

env = gym.make("YourDASHEnv-v0")  # ä½ éœ€è¦è‡ªå·±å®ç° DASH ç¯å¢ƒ
model = PPO("MlpPolicy", env, verbose=1)
model.learn(total_timesteps=100000)
```

---

# **ğŸ¯ æ€»ç»“**
âœ… **å‡†å¤‡è§†é¢‘ï¼Œå¹¶è½¬æ¢ä¸º DASH (MPD + MP4 ç‰‡æ®µ)**  
âœ… **é…ç½® Nginx ä½œä¸º DASH æœåŠ¡å™¨**  
âœ… **ä½¿ç”¨ DASH.js æ’­æ”¾è§†é¢‘ï¼Œå¹¶é‡‡é›†è®­ç»ƒæ•°æ®**  
âœ… **ç”¨ DRL è®­ç»ƒ ABRï¼ˆAdaptive Bitrateï¼‰æ¨¡å‹**  

å®Œæˆè¿™äº›æ­¥éª¤åï¼Œä½ çš„ **DRL è‡ªé€‚åº”ç ç‡ç³»ç»Ÿ** å°±èƒ½æ­£å¸¸å·¥ä½œäº† ğŸš€ï¼